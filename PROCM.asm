.model small
.data
	MUL1 DB '8640000$'
	MUL2 DB '365$'
	CAD1 DB 250 DUP ('0'), '$'
	CAD2 DB 250 DUP ('0'), '$'
	CAD3 DB 250 DUP ('0'), '$'
	ULTCONT DW 0h
	CADRESUL DB 250 DUP ('0'), '$'
	R1 DW ?
	R2 DB 0H
	CONT DB 0h
	CONT2 DB 0h
	A1 DW ?
	A2 DW ?
	AUX1 DW ?
.stack
.code
.386
programa:
;iniciar programa
	mov ax, @data
	mov ds, ax

	XOR DI, DI
	XOR SI, SI
	XOR BX, BX
	CALL Multiplicar
	mov dx, offset CADRESUL
	mov ah, 09h
	int 21h
	;salto de linea
	MOV DL, 0Ah
	MOV AH, 02h
	int 21h

jmp FIN


Multiplicar proc near
	MOV R1,0
	MOV R2,0
	MOV CONT , 0h
	MOV CONT2 , 0h
	MOV CONT , 0h
	LEA SI, MUL1
	LEA DI, MUL2
	MOV BP, SP
	MOV R1, SI
	DEC R1
FINM1:
	XOR BL, BL 
	MOV BL , [DI]
	INC R2
	INC CONT
	CMP BL,36
	JE HOLA
	INC DI
	JMP FINM1
HOLA:
	DEC R2
	DEC CONT
	DEC DI
FINM2:
	XOR BX, BX
	MOV BL , [SI]
	CMP BX, 36
	JE FM
	INC SI
	JMP FINM2
FM: 
	DEC SI
	XOR BX, BX
CONTMUL:
	XOR DX, DX
	XOR AX, AX
	XOR CX, CX
	CMP SI, R1
	JNE NOTEQUAL0SM
	JMP FIN
NOTEQUAL0SM:
	MOV DL, [SI]
	DEC SI
	SUB Dl, 30h
	MOV DI , 0h
	ADD DI , ULTCONT
	MOV AL, MUL2[DI]
	SUB Al, 30h
	MUL DL 
	ADD AX, BX
	XOR BX, BX
	CMP AX, 9h
	JLE	CONTINUA3M
CONTINUA5M:	
	SUB AX, 10
	INC BX
	CMP AX, 9h
	JG CONTINUA5M
CONTINUA3M:
	ADD AX, 30h
	PUSH AX
	CMP SI, R1
	JG CONTMUL
	ADD BX, 30h
    PUSH BX
	CMP ULTCONT, 0h
	JE PRIMERO
	CMP ULTCONT , 1h
	JE SEGUNDO
	JMP TERCERO
PRIMERO:
	LEA SI, CAD1
	JMP CONTINUA4M
SEGUNDO:
	LEA SI, CAD2
	JMP CONTINUA4M
TERCERO:	
	LEA SI, CAD3
CONTINUA4M:
	POP AX
	MOV [SI], AX
	INC SI
	CMP BP, SP
	JNE CONTINUA4M
	MOV CONT2, 0
	DEC CONT
UNCERO:	
	MOV DL, CONT2
	CMP CONT, DL
	JE NADA
	INC CONT2
	MOV AX, 30h
	MOV [SI], AX
	INC SI
	JMP UNCERO
NADA:	
	INC ULTCONT
	MOV AX, 24h
	MOV [SI], AX
	
	MOV AUX1, DI
	MOV DI, AUX1
	DEC DI				
	LEA SI, MUL1
	mov DX, ULTCONT
	CMP DL, R2
	JNE FINM2
	MOV SI, 0h
	MOV DI, 0h
	LEA SI, CAD1
	LEA DI, CAD2
	CALL PROCESUMA
	MOV SI, 0h
	MOV DI, 0h
	LEA SI, CAD3
	LEA DI, CADRESUL
	CALL PROCESUMA
RET
Multiplicar endp



PROCESUMA proc near
	MOV A1, 0
	MOV A2, 0
	MOV A1, SI
	MOV A2, DI
	DEC A1
	DEC A2
	MOV BP, SP
FINS1:
	XOR BL, BL 
	MOV BL , [SI]
	CMP BL,36
	JE FINS2
	INC SI
	JMP FINS1
FINS2:
	XOR BL, BL
	MOV BL , [DI]
	CMP BX, 36
	JE FSUM
	INC DI
	JMP FINS2
FSUM: 
	DEC DI
	DEC SI
	XOR BX, BX
CONTSUM:
	XOR DX, DX
	XOR AX, AX
	XOR CX, CX
	CMP SI, A1
	JNE NOTEQUAL0SS
	MOV DL, 0h 
	JMP CONTINUA1S
NOTEQUAL0SS:
	MOV DL, [SI]
	DEC SI
	SUB Dl, 30h
CONTINUA1S:	
	CMP DI, A2
	JNE NOTEQUAL0SD
	MOV AL, 0h 
	JMP CONTINUA2S
NOTEQUAL0SD:
	MOV AL, [DI]
	DEC DI
	SUB Al, 30h
CONTINUA2S:
	ADD AX, DX
	ADD AX, BX
	XOR BX, BX
	CMP AX, 9h
	JLE	CONTINUA3S
CONTINUA5S:	
	SUB AX, 10
	INC BX
	CMP AX, 9h
	JG CONTINUA5S
CONTINUA3S:
	ADD AX, 30h
	PUSH AX
	CMP DI, A2
	JG CONTSUM
	CMP SI, A1
	JG CONTSUM
	ADD BX, 30h
    PUSH BX
	MOV DI, 0
CONTINUA4S:
	POP AX
	CMP AX, 30h
	JE CONTINUA4S
	PUSH AX
CONTINUA6S:	
	POP AX
	MOV CADRESUL[DI], AL
	INC DI
	CMP BP, SP
	JNE CONTINUA6S
	MOV AL, 24h
	MOV CADRESUL[DI], AL
RET
PROCESUMA ENDP


FIN:	
;finalizar programa
	mov ah, 4ch
	int 21h
END programa
	
	
	
	
	
	
	
	